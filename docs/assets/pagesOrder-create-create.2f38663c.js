import{d as e,g as s,m as a,A as l,p as t,o as u,j as r,b as d,w as o,a as c,u as n,c as i,e as p,t as f,F as m,r as v,y as _,n as y,B as g,ab as b,h as x,f as k,k as h,W as I,N as j,v as w,i as F}from"./index-19e6894a.js";import{g as A,a as P,b as T,p as C}from"./order.23274447.js";import{u as M}from"./address.4f351cef.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";import"./http.8cd75bee.js";const B=V(e({__name:"create",props:{skuId:null,count:null,orderId:null},setup(e){const V=e,{safeAreaInsets:B}=s(),$=a(""),q=a([{type:1,text:"时间不限 (周一至周日)"},{type:2,text:"工作日送 (周一至周五)"},{type:3,text:"周末配送 (周六至周日)"}]),D=a(0),L=l((()=>q.value[D.value])),N=e=>{D.value=e.detail.value},O=a();t((()=>{(async()=>{if(V.count&&V.skuId){const e=await A({count:V.count,skuId:V.skuId});O.value=e.result}else if(V.orderId){const e=await P(V.orderId);O.value=e.result}else{const e=await T();O.value=e.result}})()}));const U=M(),W=l((()=>{var e;return U.selectedAddress||(null==(e=O.value)?void 0:e.userAddresses.find((e=>e.isDefault)))})),z=async()=>{var e,s;if(!(null==(e=W.value)?void 0:e.id))return g({icon:"none",title:"请选择收货地址"});const a=await C({addressId:null==(s=W.value)?void 0:s.id,buyerMessage:$.value,deliveryTimeType:L.value.type,goods:O.value.goods.map((e=>({count:e.count,skuId:e.skuId}))),payChannel:2,payType:1});b({url:`/pagesOrder/detail/detail?id=${a.result.id}`})};return(e,s)=>{var a;const l=x,t=k,g=h,b=F,A=I,P=j,T=w;return u(),r(m,null,[d(T,{"enable-back-to-top":"","scroll-y":"",class:"viewport"},{default:o((()=>[c(" 收货地址 "),n(W)?(u(),i(g,{key:0,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[d(l,{class:"user"},{default:o((()=>[p(f(n(W).receiver)+" "+f(n(W).contact),1)])),_:1}),d(l,{class:"address"},{default:o((()=>[p(f(n(W).fullLocation)+" "+f(n(W).address),1)])),_:1}),d(t,{class:"icon icon-right"})])),_:1})):(u(),i(g,{key:1,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[d(l,{class:"address"},{default:o((()=>[p(" 请选择收货地址 ")])),_:1}),d(t,{class:"icon icon-right"})])),_:1})),c(" 商品信息 "),d(l,{class:"goods"},{default:o((()=>{var e;return[(u(!0),r(m,null,v(null==(e=O.value)?void 0:e.goods,(e=>(u(),i(g,{key:e.skuId,url:`/pages/goods/goods?id=${e.id}`,class:"item","hover-class":"none"},{default:o((()=>[d(b,{class:"picture",src:e.picture},null,8,["src"]),d(l,{class:"meta"},{default:o((()=>[d(l,{class:"name ellipsis"},{default:o((()=>[p(f(e.name),1)])),_:2},1024),d(l,{class:"attrs"},{default:o((()=>[p(f(e.attrsText),1)])),_:2},1024),d(l,{class:"prices"},{default:o((()=>[d(l,{class:"pay-price symbol"},{default:o((()=>[p(f(e.payPrice),1)])),_:2},1024),d(l,{class:"price symbol"},{default:o((()=>[p(f(e.price),1)])),_:2},1024)])),_:2},1024),d(l,{class:"count"},{default:o((()=>[p("x"+f(e.count),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))]})),_:1}),c(" 配送及支付方式 "),d(l,{class:"related"},{default:o((()=>[d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("配送时间")])),_:1}),d(A,{range:q.value,"range-key":"text",onChange:N},{default:o((()=>[d(l,{class:"icon-fonts picker"},{default:o((()=>[p(f(n(L).text),1)])),_:1})])),_:1},8,["range"])])),_:1}),d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("订单备注")])),_:1}),d(P,{class:"input","cursor-spacing":30,placeholder:"选题，建议留言前先与商家沟通确认",modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=e=>$.value=e)},null,8,["modelValue"])])),_:1})])),_:1}),c(" 支付金额 "),d(l,{class:"settlement"},{default:o((()=>[d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("商品总价: ")])),_:1}),d(t,{class:"number symbol"},{default:o((()=>{var e;return[p(f(null==(e=O.value)?void 0:e.summary.totalPrice.toFixed(2)),1)]})),_:1})])),_:1}),d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("运费: ")])),_:1}),d(t,{class:"number symbol"},{default:o((()=>{var e;return[p(f(null==(e=O.value)?void 0:e.summary.postFee.toFixed(2)),1)]})),_:1})])),_:1})])),_:1})])),_:1}),c(" 吸底工具栏 "),d(l,{class:"toolbar",style:y({paddingBottom:(null==(a=n(B))?void 0:a.bottom)+"px"})},{default:o((()=>{var e;return[d(l,{class:"total-pay symbol"},{default:o((()=>[d(t,{class:"number"},{default:o((()=>{var e;return[p(f(null==(e=O.value)?void 0:e.summary.totalPayPrice.toFixed(2)),1)]})),_:1})])),_:1}),d(l,{class:_(["button",{disabled:!(null==(e=n(W))?void 0:e.id)}]),onClick:z},{default:o((()=>[p(" 提交订单 ")])),_:1},8,["class"])]})),_:1},8,["style"])],64)}}}),[["__scopeId","data-v-4042c503"]]);export{B as default};
