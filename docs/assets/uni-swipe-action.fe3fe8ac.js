import{o as t,j as e,a as o,b as s,w as n,X as i,F as a,r,c as h,n as l,K as c,e as u,t as d,f as p,h as f}from"./index-ed9e365a.js";import{_ as g}from"./plugin-vueexport-helper.1b428a4d.js";let m={},w=null;w=function(){var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],o=!0;for(let s=0;s<e.length-1;s++)if(t.indexOf(e[s])>0){o=!1;break}return o}(),m={data:()=>({is_show:"none"}),watch:{show(t){this.is_show=this.show}},created(){this.swipeaction=this.getSwipeAction(),this.swipeaction&&Array.isArray(this.swipeaction.children)&&this.swipeaction.children.push(this)},mounted(){this.is_show=this.show},methods:{closeSwipe(t){this.autoClose&&this.swipeaction&&this.swipeaction.closeOther(this)},change(t){this.$emit("change",t.open),this.is_show!==t.open&&(this.is_show=t.open)},appTouchStart(t){if(w)return;const{clientX:e}=t.changedTouches[0];this.clientX=e,this.timestamp=(new Date).getTime()},appTouchEnd(t,e,o,s){if(w)return;const{clientX:n}=t.changedTouches[0];let i=Math.abs(this.clientX-n),a=(new Date).getTime()-this.timestamp;i<40&&a<300&&this.$emit("click",{content:o,index:e,position:s})},onClickForPC(t,e,o){w&&this.$emit("click",{content:e,index:t,position:o})}}};var v=10,b=!1;function y(t,e){var o=t.instance,s=o.getDataset().disabled,n=o.getState();C(o,e),(s=("string"==typeof s?JSON.parse(s):s)||!1)||(o.requestAnimationFrame((function(){o.removeClass("ani"),e.callMethod("closeSwipe")})),n.x=n.left||0,function(t){var e=t.instance,o=e.getState();_(e);var s=t.touches[0];b&&k()&&(s=t);o.startX=s.clientX,o.startY=s.clientY}(t))}function S(t,e){var o=t.instance,s=o.getDataset().disabled,n=o.getState();(s=("string"==typeof s?JSON.parse(s):s)||!1)||(!function(t){var e=t.instance,o=e.getState(),s=t.touches[0];b&&k()&&(s=t);o.deltaX=s.clientX-o.startX,o.deltaY=s.clientY-o.startY,o.offsetY=Math.abs(o.deltaY),o.offsetX=Math.abs(o.deltaX),o.direction=o.direction||function(t,e){if(t>e&&t>v)return"horizontal";if(e>t&&e>v)return"vertical";return""}(o.offsetX,o.offsetY)}(t),"horizontal"===n.direction&&(t.preventDefault&&t.preventDefault(),T(n.x+n.deltaX,o)))}function x(t,e){var o=t.instance,s=o.getDataset().disabled,n=o.getState();(s=("string"==typeof s?JSON.parse(s):s)||!1)||function(t,e,o){var s=e.getState(),n=s.threshold;s.position;var i=s.isopen||"none",a=s.leftWidth,r=s.rightWidth;if(0===s.deltaX)return void X("none",e,o);X("none"===i&&r>0&&-t>n||"none"!==i&&r>0&&r+t<n?"right":"none"===i&&a>0&&t>n||"none"!==i&&a>0&&a-t<n?"left":"none",e,o)}(n.left,o,e)}function T(t,e,o){t=t||0;var s,n,i,a=e.getState(),r=a.leftWidth,h=a.rightWidth;a.left=(s=t,n=-h,i=r,Math.min(Math.max(s,n),i)),e.requestAnimationFrame((function(){e.setStyle({transform:"translateX("+a.left+"px)","-webkit-transform":"translateX("+a.left+"px)"})}))}function C(t,e){var o,s,n=t.getState(),i=e.selectComponent(".button-group--left"),a=e.selectComponent(".button-group--right");o=i.getBoundingClientRect(),s=a.getBoundingClientRect(),n.leftWidth=o.width||0,n.rightWidth=s.width||0,n.threshold=t.getDataset().threshold}function X(t,e,o){var s=e.getState(),n=s.leftWidth,i=s.rightWidth,a="";switch(s.isopen=s.isopen?s.isopen:"none",t){case"left":a=n;break;case"right":a=-i;break;default:a=0}s.isopen!==t&&(s.throttle=!0,o.callMethod("change",{open:t})),s.isopen=t,e.requestAnimationFrame((function(){e.addClass("ani"),T(a,e)}))}function _(t){var e=t.getState();e.direction="",e.deltaX=0,e.deltaY=0,e.offsetX=0,e.offsetY=0}function k(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],o=!0,s=0;s<e.length-1;s++)if(t.indexOf(e[s])>0){o=!1;break}return o}"object"==typeof window&&(b=!0);var D=!1;const $={showWatch:function(t,e,o,s){var n=s.getState();C(s,o),t&&"none"!==t?X(t,s,o):(n.left&&X("none",s,o),_(s))},touchstart:y,touchmove:S,touchend:x,mousedown:function(t,e){b&&k()&&(y(t,e),D=!0)},mousemove:function(t,e){b&&k()&&D&&S(t)},mouseup:function(t,e){b&&k()&&(x(t,e),D=!1)},mouseleave:function(t,e){b&&k()&&(D=!1)}},W=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("wxsswipe"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.wxsswipe=$}})},F={showWatch(t,e,o,s,n){var i=n.state;(o.$el||o.$vm&&o.$vm.$el)&&(this.getDom(s,o,n),t&&"none"!==t?this.openState(t,s,o,n):(i.left&&this.openState("none",s,o,n),this.resetTouchStatus(s,n)))},touchstart(t,e,o){let s=t.instance,n=s.getDataset().disabled,i=o.state;this.getDom(s,e,o),n=this.getDisabledType(n),n||(s.requestAnimationFrame((function(){s.removeClass("ani"),e.callMethod("closeSwipe")})),i.x=i.left||0,this.stopTouchStart(t,e,o))},touchmove(t,e,o){let s=t.instance;if(!s)return;let n=s.getDataset().disabled,i=o.state;if(n=this.getDisabledType(n),n)return;if(this.stopTouchMove(t,o),"horizontal"!==i.direction)return;t.preventDefault&&t.preventDefault();let a=i.x+i.deltaX;this.move(a,s,e,o)},touchend(t,e,o){let s=t.instance,n=s.getDataset().disabled,i=o.state;n=this.getDisabledType(n),n||this.moveDirection(i.left,s,e,o)},move(t,e,o,s){t=t||0;let n=s.state,i=n.leftWidth,a=n.rightWidth;n.left=this.range(t,-a,i),e.requestAnimationFrame((function(){e.setStyle({transform:"translateX("+n.left+"px)","-webkit-transform":"translateX("+n.left+"px)"})}))},getDom(t,e,o){var s=o.state,n=e.$el||e.$vm&&e.$vm.$el,i=n.querySelector(".button-group--left"),a=n.querySelector(".button-group--right");s.leftWidth=i.offsetWidth||0,s.rightWidth=a.offsetWidth||0,s.threshold=t.getDataset().threshold},getDisabledType:t=>("string"==typeof t?JSON.parse(t):t)||!1,range:(t,e,o)=>Math.min(Math.max(t,e),o),moveDirection(t,e,o,s){var n=s.state,i=n.threshold;n.position;var a=n.isopen||"none",r=n.leftWidth,h=n.rightWidth;0!==n.deltaX?"none"===a&&h>0&&-t>i||"none"!==a&&h>0&&h+t<i?this.openState("right",e,o,s):"none"===a&&r>0&&t>i||"none"!==a&&r>0&&r-t<i?this.openState("left",e,o,s):this.openState("none",e,o,s):this.openState("none",e,o,s)},openState(t,e,o,s){let n=s.state,i=n.leftWidth,a=n.rightWidth,r="";switch(n.isopen=n.isopen?n.isopen:"none",t){case"left":r=i;break;case"right":r=-a;break;default:r=0}n.isopen!==t&&(n.throttle=!0,o.callMethod("change",{open:t})),n.isopen=t,e.requestAnimationFrame((()=>{e.addClass("ani"),this.move(r,e,o,s)}))},getDirection:(t,e)=>t>e&&t>10?"horizontal":e>t&&e>10?"vertical":"",resetTouchStatus(t,e){let o=e.state;o.direction="",o.deltaX=0,o.deltaY=0,o.offsetX=0,o.offsetY=0},stopTouchStart(t,e,o){let s=t.instance,n=o.state;this.resetTouchStatus(s,o);var i=t.touches[0];n.startX=i.clientX,n.startY=i.clientY},stopTouchMove(t,e){t.instance;let o=e.state,s=t.touches[0];o.deltaX=s.clientX-o.startX,o.deltaY=s.clientY-o.startY,o.offsetY=Math.abs(o.deltaY),o.offsetX=Math.abs(o.deltaX),o.direction=o.direction||this.getDirection(o.offsetX,o.offsetY)}},Y={mounted(t,e,o){this.state={}},methods:{showWatch(t,e,o,s){F.showWatch(t,e,o,s,this)},touchstart(t,e){F.touchstart(t,e,this)},touchmove(t,e){F.touchmove(t,e,this)},touchend(t,e){F.touchend(t,e,this)}}},A=t=>{t.$renderjs||(t.$renderjs=[]),t.$renderjs.push("renderswipe"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.renderswipe=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),t.mixins.push(Y)},M={mixins:[m,{},{}],emits:["click","change"],props:{show:{type:String,default:"none"},disabled:{type:Boolean,default:!1},autoClose:{type:Boolean,default:!0},threshold:{type:Number,default:20},leftOptions:{type:Array,default:()=>[]},rightOptions:{type:Array,default:()=>[]}},unmounted(){this.__isUnmounted=!0,this.uninstall()},methods:{uninstall(){this.swipeaction&&this.swipeaction.children.forEach(((t,e)=>{t===this&&this.swipeaction.children.splice(e,1)}))},getSwipeAction(t="uniSwipeAction"){let e=this.$parent,o=e.$options.name;for(;o!==t;){if(e=e.$parent,!e)return!1;o=e.$options.name}return e}}};W(M),A(M);const O=g(M,[["render",function(g,m,w,v,b,y){const S=p,x=f;return t(),e(a,null,[o(" 在微信小程序 app vue端 h5 使用wxs 实现"),s(x,{class:"uni-swipe"},{default:n((()=>[s(x,{class:"uni-swipe_box","change:prop":g.wxsswipe.showWatch,prop:g.is_show,"data-threshold":w.threshold,"data-disabled":w.disabled,onTouchstart:g.wxsswipe.touchstart,onTouchmove:g.wxsswipe.touchmove,onTouchend:g.wxsswipe.touchend},{default:n((()=>[o(" 在微信小程序 app vue端 h5 使用wxs 实现"),s(x,{class:"uni-swipe_button-group button-group--left"},{default:n((()=>[i(g.$slots,"left",{},(()=>[(t(!0),e(a,null,r(w.leftOptions,((e,o)=>(t(),h(x,{key:o,style:l({backgroundColor:e.style&&e.style.backgroundColor?e.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:g.appTouchStart,onTouchend:t=>g.appTouchEnd(t,o,e,"left"),onClick:c((t=>g.onClickForPC(o,e,"left")),["stop"])},{default:n((()=>[s(S,{class:"uni-swipe_button-text",style:l({color:e.style&&e.style.color?e.style.color:"#FFFFFF",fontSize:e.style&&e.style.fontSize?e.style.fontSize:"16px"})},{default:n((()=>[u(d(e.text),1)])),_:2},1032,["style"])])),_:2},1032,["style","onTouchstart","onTouchend","onClick"])))),128))]),!0)])),_:3}),s(x,{class:"uni-swipe_text--center"},{default:n((()=>[i(g.$slots,"default",{},void 0,!0)])),_:3}),s(x,{class:"uni-swipe_button-group button-group--right"},{default:n((()=>[i(g.$slots,"right",{},(()=>[(t(!0),e(a,null,r(w.rightOptions,((e,o)=>(t(),h(x,{key:o,style:l({backgroundColor:e.style&&e.style.backgroundColor?e.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:g.appTouchStart,onTouchend:t=>g.appTouchEnd(t,o,e,"right"),onClick:c((t=>g.onClickForPC(o,e,"right")),["stop"])},{default:n((()=>[s(S,{class:"uni-swipe_button-text",style:l({color:e.style&&e.style.color?e.style.color:"#FFFFFF",fontSize:e.style&&e.style.fontSize?e.style.fontSize:"16px"})},{default:n((()=>[u(d(e.text),1)])),_:2},1032,["style"])])),_:2},1032,["style","onTouchstart","onTouchend","onClick"])))),128))]),!0)])),_:3})])),_:3},8,["change:prop","prop","data-threshold","data-disabled","onTouchstart","onTouchmove","onTouchend"])])),_:3}),o(" app nvue端 使用 bindingx "),o(" 其他平台使用 js ，长列表性能可能会有影响")],2112)}],["__scopeId","data-v-afefe4e6"]]);const z=g({name:"uniSwipeAction",data:()=>({}),created(){this.children=[]},methods:{resize(){},closeAll(){this.children.forEach((t=>{t.is_show="none"}))},closeOther(t){this.openItem&&this.openItem!==t&&(this.openItem.is_show="none"),this.openItem=t}}},[["render",function(e,o,s,a,r,l){const c=f;return t(),h(c,null,{default:n((()=>[i(e.$slots,"default")])),_:3})}]]);export{O as _,z as a};
