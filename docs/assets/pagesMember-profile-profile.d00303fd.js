import{d as a,g as e,m as l,p as t,x as s,o as r,c as n,w as u,a as o,b as c,e as d,n as i,u as f,t as p,Q as v,R as m,B as _,P as h,k as g,h as b,i as k,f as y,N as S,T as Y,U as x,V as C,W as D,D as V}from"./index-ed9e365a.js";import{h as M}from"./http.86124fb0.js";import{_ as w}from"./plugin-vueexport-helper.1b428a4d.js";const H=(a,e="YYYY-MM-DD HH:mm:ss")=>{const l=String(a.getFullYear()),t=String(a.getMonth()+1).padStart(2,"0"),s=String(a.getDate()).padStart(2,"0"),r=String(a.getHours()).padStart(2,"0"),n=String(a.getMinutes()).padStart(2,"0"),u=String(a.getSeconds()).padStart(2,"0");return e.replace("YYYY",l).replace("MM",t).replace("DD",s).replace("HH",r).replace("mm",n).replace("ss",u)},T=w(a({__name:"profile",setup(a){const{safeAreaInsets:w}=e(),T=l({}),P=async()=>{const a=await M({method:"GET",url:"/member/profile"});T.value=a.result,U.profile.avatar=a.result.avatar,U.profile.nickname=a.result.nickname};t((()=>{P()}));const U=s(),j=()=>{v({count:1,success:a=>{const e=a.tempFilePaths;F(e[0])}})},F=a=>{m({url:"/member/profile/avatar",name:"file",filePath:a,success:a=>{if(200===a.statusCode){const e=JSON.parse(a.data).result.avatar;T.value.avatar=e,U.profile.avatar=e,_({icon:"success",title:"更新成功"})}else _({icon:"error",title:"出现错误"})}})},B=a=>{T.value.gender=a.detail.value},I=a=>{T.value.birthday=a.detail.value};let N=["","",""];const A=async()=>{const{nickname:a,gender:e,birthday:l,profession:t}=T.value,s=await(r={nickname:a,gender:e,birthday:l,profession:t,provinceCode:N[0],cityCode:N[1],countyCode:N[2]},M({method:"PUT",url:"/member/profile",data:r}));var r;U.profile.nickname=s.result.nickname,_({icon:"success",title:"保存成功"}),setTimeout((()=>{h()}),400)};return(a,e)=>{const l=g,t=b,s=k,v=y,m=S,_=Y,h=x,M=C,P=D,U=V;return r(),n(t,{class:"viewport"},{default:u((()=>{var a;return[o(" 导航栏 "),c(t,{class:"navbar",style:i({paddingTop:(null==(a=f(w))?void 0:a.top)+"px"})},{default:u((()=>[c(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),c(t,{class:"title"},{default:u((()=>[d("个人信息")])),_:1})])),_:1},8,["style"]),o(" 头像 "),c(t,{class:"avatar"},{default:u((()=>[c(t,{onClick:j,class:"avatar-content"},{default:u((()=>{var a;return[c(s,{class:"image",src:null==(a=T.value)?void 0:a.avatar,mode:"aspectFill"},null,8,["src"]),c(v,{class:"text"},{default:u((()=>[d("点击修改头像")])),_:1})]})),_:1})])),_:1}),o(" 表单 "),c(t,{class:"form"},{default:u((()=>[o(" 表单内容 "),c(t,{class:"form-content"},{default:u((()=>[c(t,{class:"form-item"},{default:u((()=>[c(v,{class:"label"},{default:u((()=>[d("账号")])),_:1}),c(v,{class:"account placeholder"},{default:u((()=>{var a;return[d(p(null==(a=T.value)?void 0:a.account),1)]})),_:1})])),_:1}),c(t,{class:"form-item"},{default:u((()=>[c(v,{class:"label"},{default:u((()=>[d("昵称")])),_:1}),c(m,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:T.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>T.value.nickname=a)},null,8,["modelValue"])])),_:1}),c(t,{class:"form-item"},{default:u((()=>[c(v,{class:"label"},{default:u((()=>[d("性别")])),_:1}),c(M,{onChange:B},{default:u((()=>[c(h,{class:"radio"},{default:u((()=>{var a;return[c(_,{value:"男",color:"#27ba9b",checked:"男"===(null==(a=T.value)?void 0:a.gender)},null,8,["checked"]),d(" 男 ")]})),_:1}),c(h,{class:"radio"},{default:u((()=>{var a;return[c(_,{value:"女",color:"#27ba9b",checked:"女"===(null==(a=T.value)?void 0:a.gender)},null,8,["checked"]),d(" 女 ")]})),_:1})])),_:1})])),_:1}),c(t,{class:"form-item"},{default:u((()=>{var a;return[c(v,{class:"label"},{default:u((()=>[d("生日")])),_:1}),c(P,{onChange:I,mode:"date",class:"picker",value:null==(a=T.value)?void 0:a.birthday,start:"1900-01-01",end:f(H)(new Date)},{default:u((()=>{var a;return[(null==(a=T.value)?void 0:a.birthday)?(r(),n(t,{key:0},{default:u((()=>{var a;return[d(p(null==(a=T.value)?void 0:a.birthday),1)]})),_:1})):(r(),n(t,{key:1,class:"placeholder"},{default:u((()=>[d("请选择日期")])),_:1}))]})),_:1},8,["value","end"])]})),_:1}),o(" 只有微信小程序端内置了省市区数据 "),c(t,{class:"form-item"},{default:u((()=>[c(v,{class:"label"},{default:u((()=>[d("职业")])),_:1}),c(m,{class:"input",type:"text",placeholder:"请填写职业",modelValue:T.value.profession,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value.profession=a)},null,8,["modelValue"])])),_:1})])),_:1}),o(" 提交按钮 "),c(U,{onClick:A,class:"form-button"},{default:u((()=>[d("保 存")])),_:1})])),_:1})]})),_:1})}}}),[["__scopeId","data-v-7d9634f5"]]);export{T as default};
